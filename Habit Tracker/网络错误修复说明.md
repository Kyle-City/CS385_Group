# 网络错误修复说明

## 🔍 问题原因

前端配置的 IP 地址 (`10.132.100.124`) 与当前电脑的实际 IP 地址 (`192.168.22.225`) 不匹配，导致无法连接。

## ✅ 已修复

1. **更新前端 API 地址**：
   - `frontend/context/AuthContext.js` → `http://192.168.22.225:3000`
   - `frontend/services/api.js` → `http://192.168.22.225:3000`

2. **改进 CORS 配置**：
   - 允许所有来源访问（开发环境）
   - 明确允许的方法和请求头

## 🚀 需要执行的操作

### 1. 重启后端服务器

在运行后端的终端中：
- 按 `Ctrl+C` 停止服务器
- 重新启动：
  ```powershell
  cd "D:\CS385 Final Project\CS385_Group\Habit Tracker\backend"
  npm run dev
  ```

### 2. 重启前端应用

在 Expo 终端中：
- 按 `r` 重新加载应用
- 或按 `Ctrl+C` 停止后重新启动：
  ```powershell
  cd "D:\CS385 Final Project\CS385_Group\Habit Tracker\frontend"
  npm start
  ```

### 3. 在手机上重新扫描二维码

- 完全关闭 Expo Go 应用
- 重新打开并扫描新的二维码

## ⚠️ 重要提示

### IP 地址可能会变化

如果你的电脑 IP 地址改变了（例如重新连接 Wi-Fi），需要：

1. **查找新的 IP 地址**：
   ```powershell
   ipconfig | findstr /i "IPv4"
   ```
   找到主要的 IPv4 地址（通常是 `192.168.x.x` 或 `10.x.x.x`）

2. **更新前端配置**：
   - 编辑 `frontend/context/AuthContext.js` 第 5 行
   - 编辑 `frontend/services/api.js` 第 4 行
   - 将 IP 地址改为新的地址

3. **重启前端应用**

### 确保网络连接

- ✅ 手机和电脑必须连接到**同一个 Wi-Fi 网络**
- ✅ 确保防火墙允许端口 3000
- ✅ 某些公共 Wi-Fi 可能阻止设备间通信

## 🧪 测试连接

重启后，尝试登录/注册。如果仍然失败：

1. **检查后端日志**：查看是否有错误信息
2. **检查前端控制台**：在 Expo Go 中摇动手机，打开开发者菜单，查看错误
3. **测试 API**：运行测试脚本：
   ```powershell
   cd "D:\CS385 Final Project\CS385_Group\Habit Tracker\backend"
   powershell -ExecutionPolicy Bypass -File test-api.ps1
   ```

## 📱 如果使用模拟器

如果你使用的是 Android/iOS 模拟器而不是真实设备：

- Android 模拟器：使用 `http://10.0.2.2:3000`（模拟器的 localhost 映射）
- iOS 模拟器：使用 `http://localhost:3000`
- 真实设备：使用电脑的 IP 地址（当前是 `192.168.22.225`）





